{
  "name": "flow1",
  "description": "This is the default flow containing all of the default steps",
  "batchSize": 100,
  "threadCount": 4,
  "steps": {
    "1": {
      "name": "ingestion-step",
      "description": "This is the default ingestion step",
      "stepDefinitionName": "default-ingestion",
      "stepDefinitionType": "INGESTION",
      "customHook": {},
      "fileLocations": {
        "inputFilePath": "data/data",
        "outputURIReplacement": ".*data,''",
        "inputFileType": "json"
      },
      "options": {
        "outputFormat": "json",
        "collections": [
          "raw"
        ],
        "headers": {
          "sources": [
            {
              "name": "flow1"
            }
          ],
          "createdOn": "currentDateTime",
          "createdBy": "currentUser"
        }
      },
      "customHook": {
        "module": "/ferb/hook.sjs",
        "user": "admin",
        "runBefore": false
      }
    },
    "2": {
      "name": "map-films",
      "stepDefinitionName": "ferb",
      "stepDefinitionType": "CUSTOM",
      "options": {
        "sourceQuery": "cts.collectionQuery(['film'])",
        "collections": [
          "Entity" ,"Film"
        ],
        "genericHarmonize": {
          "entity": {
            "type": "Film",
            "version": "1.0.0"
          },
          "referenceDataMappings": [
            {
              "path": "language_id",
              "type": "language",
              "propertyName": "language"
            }
          ]
        }
      }
    },
    "3": {
      "name": "map-rentals",
      "stepDefinitionName": "ferb",
      "stepDefinitionType": "CUSTOM",
      "options": {
        "sourceQuery": "cts.collectionQuery(['rental'])",
        "collections": [
          "Entity", "Rental"
        ],
        "genericHarmonize": {
          "entity": {
            "type": "Rental",
            "version": "1.0.0"
          }
        }
      }
    },
    "4": {
      "name": "map-customers",
      "stepDefinitionName": "ferb",
      "stepDefinitionType": "CUSTOM",
      "options": {
        "sourceQuery": "cts.collectionQuery(['customer'])",
        "collections": [
          "Entity", "Customer"
        ],
        "genericHarmonize": {
          "entity": {
            "type": "Customer",
            "version": "1.0.0"
          },
          "childQueries": [
            {
              "childCollection": "address",
              "childPropertyName": "address_id",
              "newPropertyName": "address",
              "childPropertyHasRangeIndex": true,
              "referenceDataMappings": [
                {
                  "path": "city_id",
                  "type": "city",
                  "propertyName": "city"
                }
              ]
            }
          ]
        }
      }
    },
    "5": {
      "name": "map-stores",
      "stepDefinitionName": "ferb",
      "stepDefinitionType": "CUSTOM",
      "options": {
        "sourceQuery": "cts.collectionQuery(['store'])",
        "collections": [
          "Entity", "Store"
        ],
        "genericHarmonize": {
          "entity": {
            "type": "Store",
            "version": "1.0.0"
          },
          "childQueries": [
            {
              "childCollection": "address",
              "childPropertyName": "address_id",
              "newPropertyName": "address",
              "childPropertyHasRangeIndex": true,
              "referenceDataMappings": [
                {
                  "path": "city_id",
                  "type": "city",
                  "propertyName": "city"
                }
              ]
            }
          ]
        }
      }
    },
    "6": {
      "name": "map-staff",
      "stepDefinitionName": "ferb",
      "stepDefinitionType": "CUSTOM",
      "options": {
        "sourceQuery": "cts.collectionQuery(['staff'])",
        "collections": [
          "Entity", "Staff"
        ],
        "genericHarmonize": {
          "entity": {
            "type": "Staff",
            "version": "1.0.0"
          },
          "childQueries": [
            {
              "childCollection": "address",
              "childPropertyName": "address_id",
              "newPropertyName": "address",
              "childPropertyHasRangeIndex": true,
              "referenceDataMappings": [
                {
                  "path": "city_id",
                  "type": "city",
                  "propertyName": "city"
                }
              ]
            }
          ]
        }
      }
    }
  }
}
